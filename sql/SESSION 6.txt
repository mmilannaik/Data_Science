select name, LEFT (NAME, CHARINDEX(' ' , NAME)) AS 'FNAME' from  emp;

select getdate (), DATEADD(YY, 1, GETDATE());

SELECT EID, NAME, DOJ , DATEADD(M, 9, DOJ) AS 'CONFIRMATION DATE', DATEDIFF (YY, DOJ, GETDATE()) AS 'TENURE' FROM EMP;

SELECT GETDATE(), DAY(GETDATE()) AS 'DAY' , MONTH(GETDATE()) AS 'MONTH' , YEAR(GETDATE()) AS 'YEETDATEAR' ;

SELECT GETDATE(), DATEPART(D, GETDATE()) AS 'DAY' , DATEPART(M,GETDATE()) AS 'MONTH' , DATEPART(YY,GETDATE()) AS 'YEAR' ;


SELECT GETDATE(),CONVERT (VARCHAR(20), GETDATE(), 110);

SELECT GETDATE(), FORMAT(GETDATE(),'D'), FORMAT(GETDATE(),'M'), FORMAT(GETDATE(),'Y');

SELECT EID, FORMAT(DOJ, 'D') FROM EMP;

USE LEARN3;

CREATE FUNCTION MYSUM	 (@X AS INT , @Y AS INT)
RETURNS INT
AS
BEGIN
		DECLARE @Z AS INT;
		SET @Z= @X+@Y;
		RETURN @Z;
END;


SELECT DBO.MYSUM(10,20);

DROP FUNCTION DBO.MYSUM;

CREATE FUNCTION CAL (@A AS INT, @B AS INT, @O AS CHAR(1))
RETURNS INT
AS
BEGIN
		DECLARE @R AS INT;

		IF @O = '+'
			SET @R = @A + @B;
		ELSE IF @O = '-'
			SET @R = @A - @B;
		ELSE IF @O = '*'
			SET @R = @A * @B;
		ELSE IF @O = '/'
			SET @R = @A / @B;
		ELSE IF @O = '%'
			SET @R = @A % @B;
		ELSE 
			SET @R=0;
	RETURN @R;

END;

SELECT DBO.CAL(16,5,'/');

-- SCALAR FUNCTION / SINGLE VALUED FUNCTION
-- TABLE VALUED FUNCTION

USE TEST;

DROP FUNCTION L_SALDETAIL;

CREATE FUNCTION L_SALDETAIL(@X AS VARCHAR(20))
RETURNS TABLE
AS
	RETURN (SELECT * FROM EMP_SAL
			WHERE DEPT =@X);

SELECT * FROM DBO.L_SALDETAIL('ADMIN');
DROP FUNCTION L_TENURE;

CREATE FUNCTION L_TENURE(@X AS INT)
RETURNS TABLE
AS
	RETURN (SELECT EMP.EID,NAME, CITY, DEPT, DESI, DOJ, DATEDIFF(YY,DOJ,GETDATE()) As 'Tenure' 
	from emp
	INNER JOIN EMP_SAL
	ON EMP.EID=EMP_SAL.EID
	WHERE DATEDIFF(YY,DOJ,GETDATE()) >=@X);


SELECT * FROM DBO.L_TENURE(8);


-- RG001@RCG.COM