USE TEST;
SELECT * FROM EMP WHERE CITY ='DELHI';

SELECT * FROM EMP WHERE ADDRESS2='DWARKA';

create INDEX INCY ON EMP (CITY);


DROP INDEX INCY ON EMP;

--IMPLICIT - AUTOMATICALLY CREATED (PRIMARY KEY / UNIQUE)

-- EXPLICIT - WE CREATE

-- COMPOSIT INDEX
 
 create INDEX INCY ON EMP (CITY, ADDRESS2);


 -- CLUSTERED INDEX
 -- NON CLUSTERED INDEX

 create CLUSTERED INDEX INCY ON EMP (CITY);

 SELECT * FROM EMP;
 DROP VIEW VMEMP;
 CREATE VIEW VMEMP
 AS
 (SELECT * FROM EMP 
  WHERE  CITY = 'MUMBAI');

  SELECT * FROM VMEMP;

  INSERT INTO EMP
  VALUES (1072,'ROSHAN SING', '2415 PARK VIEW STREET', 'BANDRA' , 'MUMBAI', '9911008989', 'RS72@GMAIL.COM','11-NOV-1995', '05-JAN-2020');

  DELETE FROM EMP WHERE EID = 1072;

  INSERT INTO VMEMP
  VALUES (1072,'ROSHAN SING', '2415 PARK VIEW STREET', 'SECTOR 17' , 'CHANDIGARH', '9911008989', 'RS72@GMAIL.COM','11-NOV-1995', '05-JAN-2020');


 CREATE VIEW VMEMP
 AS
	SELECT * FROM EMP 
	WHERE  CITY = 'MUMBAI'
	with check option;

 select * from VMemp;

 CREATE VIEW VMEMP
 AS
	SELECT EID, NAME, CITY, EMAIL, DOJ FROM EMP
	WHERE CITY = 'MUMBAI';


CREATE VIEW VIEMP
AS
	SELECT EMP.EID, NAME, CITY, DOJ, DEPT, DESI, SALARY AS 'BASIC', SALARY *.15 AS 'HRA' , SALARY *.09 AS 'PF'
	FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID=EMP_SAL.EID;

SELECT * FROM VIEMP;

SELECT DISTINCT CITY FROM EMP;

SELECT COUNT (EID), SUM(SALARY) FROM EMP_SAL
GROUP BY DEPT;

SELECT * FROM EMP_SAL;

SELECT DEPT, SUM(SALARY) AS 'TOTAL COST'FROM EMP_SAL
GROUP BY DEPT
ORDER BY SUM(SALARY) DESC;


SELECT COUNT(EID),mAX(SALARY ), MIN(SALARY), AVG(SALARY) , SUM (SALARY) FROM EMP_SAL;

SELECT SQRT(16);

SELECT RAND();

SELECT CONCAT('HELLO', 'WORLD');

SELECT EID, NAME, CONCAT(ADDRESS1,' ', ADDRESS2,' ', CITY) AS'ADDRESS'FROM EMP;

SELECT ASCII('A'), CHAR(65);


SELECT CHARINDEX('E', 'WELCOME');

SELECT NAME, CHARINDEX(' ', NAME) FROM EMP;

SELECT NAME, LEFT (NAME, 2) , RIGHT (NAME,2) , LEN (NAME) , LOWER  (NAME) , UPPER (NAME) FROM EMP;

SELECT SUBSTRING('WELCOME', 2, 3);

SELECT REPLACE ('INDIA', 'I', 'K');

SELECT REVERSE ('INDIA');

SELECT STUFF('ABCDEFGHIJKL',3, 4, 'XYZ');
